{% extends 'base.html' %}
{% load static %}
{% block title %}My Orders · Masala Story{% endblock %}
{% block header %}My Orders{% endblock %}
{% block content %}
<style>
.order-card {
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.08);
  border: 1px solid #e9ecef;
  margin-bottom: 1.5rem;
  overflow: hidden;
  transition: all 0.3s ease;
}

.order-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 20px rgba(0,0,0,0.12);
}

.order-header {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 1rem 1.5rem;
}

.order-body {
  padding: 1.5rem;
}

.product-item {
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  border-bottom: 1px solid #f8f9fa;
  background: white;
  border-radius: 8px;
  margin-bottom: 0.5rem;
  transition: all 0.3s ease;
}

.product-item:hover {
  transform: translateY(-1px);
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.product-item:last-child {
  border-bottom: none;
  margin-bottom: 0;
}

.product-image {
  width: 60px;
  height: 60px;
  border-radius: 8px;
  object-fit: cover;
  border: 1px solid #e9ecef;
  flex-shrink: 0;
}

.product-info {
  flex: 1;
  min-width: 0;
}

.product-name {
  font-weight: 600;
  color: #333;
  margin-bottom: 0.5rem;
  font-size: 1rem;
  line-height: 1.3;
}

.product-details {
  font-size: 0.875rem;
  color: #666;
  line-height: 1.4;
}

.order-summary {
  background: #f8f9fa;
  border-radius: 8px;
  padding: 1.5rem;
  margin-top: 1rem;
  border: 1px solid #e9ecef;
}

.btn-view-details {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border: none;
  color: white;
  padding: 0.5rem 1.5rem;
  border-radius: 8px;
  font-weight: 600;
  transition: all 0.3s ease;
}

.btn-view-details:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
  background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
  color: white;
}

.status-badge {
  padding: 0.4rem 0.8rem;
  border-radius: 20px;
  font-size: 0.875rem;
  font-weight: 600;
}

.status-paid {
  background: #d4edda;
  color: #155724;
}

.status-pending {
  background: #fff3cd;
  color: #856404;
}

@media (max-width: 768px) {
  .order-body {
    padding: 1rem;
  }
  
  .product-item {
    flex-direction: row;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem;
  }
  
  .product-image {
    width: 50px;
    height: 50px;
  }
  
  .product-name {
    font-size: 0.9rem;
  }
  
  .product-details {
    font-size: 0.8rem;
  }
  
  .order-summary {
    padding: 1rem;
  }
}
</style>

<div class="py-3">
  {% if messages %}
    {% for message in messages %}
      <div class="alert alert-{{ message.tags|default:'success' }}">{{ message }}</div>
    {% endfor %}
  {% endif %}

  {% if orders %}
    <div class="row">
      {% for order in orders %}
        <div class="col-12">
          <div class="order-card">
            <div class="order-header">
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <h5 class="mb-1">Order #{{ order.id }}</h5>
                  <small class="opacity-90">
                    <i class="bi bi-calendar me-1"></i>
                    Placed on {{ order.ordered_at|slice:":19" }}
                  </small>
                </div>
                <div class="text-end">
                  <div class="h5 mb-1">₹{{ order.total }}</div>
                  <span class="status-badge status-paid">
                    <i class="bi bi-check-circle me-1"></i>Paid
                  </span>
                </div>
              </div>
            </div>
            
            <div class="order-body">
              <div class="mb-3">
                <h6 class="mb-2">
                  <i class="bi bi-box-seam me-2"></i>Order Items ({{ order.items|length }})
                </h6>
                {% for item in order.items %}
                  <div class="product-item">
                    <img src="{% static 'img/products/Whole spices/cardamom-thumb.webp' %}" 
                         alt="{{ item.name }}" 
                         class="product-image"
                         onerror="this.src='{% static 'img/logo.png' %}'">
                    <div class="product-info">
                      <div class="product-name">{{ item.name }}</div>
                      <div class="product-details">
                        Qty: {{ item.quantity }} × ₹{{ item.price }} = ₹{{ item.line_total }}
                      </div>
                    </div>
                  </div>
                {% endfor %}
              </div>
              
              <div class="order-summary">
                <div class="d-flex justify-content-between align-items-center">
                  <div>
                    <strong>Total Amount</strong>
                    <br>
                    <small class="text-muted">
                      <i class="bi bi-truck me-1"></i>
                      Arriving by {{ order.arrival_date }}
                    </small>
                  </div>
                  <div class="text-end">
                    <div class="h5 mb-3 text-primary">₹{{ order.total }}</div>
                    <a href="{% url 'cart:order_detail' order.id %}" class="btn btn-view-details">
                      <i class="bi bi-eye me-1"></i>View Details
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="text-center py-5">
      <div class="alert alert-info">
        <i class="bi bi-inbox display-4 d-block mb-3"></i>
        <h4>No Orders Yet</h4>
        <p class="mb-3">You haven't placed any orders yet. Start shopping to see your orders here!</p>
        <a href="{% url 'catalog:product_list' %}" class="btn btn-primary">
          <i class="bi bi-shop me-2"></i>Start Shopping
        </a>
      </div>
    </div>
  {% endif %}
</div>
{% endblock %}


